# é—¹é’ŸåŸç”Ÿé›†æˆå®Œæ•´å®ç°æ–¹æ¡ˆ (æ–¹æ¡ˆ B)

## ğŸ“‹ ç›®æ ‡
å®ç°ä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„æ™ºèƒ½é—¹é’Ÿç³»ç»Ÿï¼Œæ”¯æŒï¼š
- âœ… åå°è§¦å‘ï¼ˆåº”ç”¨å…³é—­æ—¶ä¹Ÿèƒ½å“é“ƒï¼‰
- âœ… è‡ªåŠ¨å¼¹å‡ºå…¨å±å”¤é†’é¡µé¢
- âœ… è‡ªå®šä¹‰é“ƒå£°æˆ– AI è¯­éŸ³æ’­æŠ¥
- âœ… äº’åŠ¨ä»»åŠ¡ï¼ˆæ‘‡ä¸€æ‘‡ã€ç­”é¢˜ç­‰ï¼‰
- âœ… å°ç¡ï¼ˆSnoozeï¼‰åŠŸèƒ½
- âœ… æ•°æ®æŒä¹…åŒ–ï¼ˆSupabaseï¼‰

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         React Native / Expo             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   å‰ç«¯ UI å±‚                       â”‚  â”‚
â”‚  â”‚   - å”¤é†’é¡µé¢ (Wake Up Screen)     â”‚  â”‚
â”‚  â”‚   - é—¹é’Ÿç®¡ç†é¡µé¢                   â”‚  â”‚
â”‚  â”‚   - äº’åŠ¨ä»»åŠ¡ç»„ä»¶                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â†•                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   ä¸šåŠ¡é€»è¾‘å±‚                       â”‚  â”‚
â”‚  â”‚   - é—¹é’Ÿè°ƒåº¦ç®¡ç†å™¨                 â”‚  â”‚
â”‚  â”‚   - å£°éŸ³æ’­æ”¾æ§åˆ¶å™¨                 â”‚  â”‚
â”‚  â”‚   - ä»»åŠ¡éªŒè¯é€»è¾‘                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â†•                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   åŸç”Ÿæ¨¡å—å±‚ (iOS/Android)        â”‚  â”‚
â”‚  â”‚   - UNUserNotificationCenter      â”‚  â”‚
â”‚  â”‚   - AVAudioPlayer                  â”‚  â”‚
â”‚  â”‚   - Background Tasks               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†•
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Supabase DB   â”‚
         â”‚   - alarms è¡¨   â”‚
         â”‚   - wake_events â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ ä¾èµ–åŒ…è§„åˆ’

### 1. æ ¸å¿ƒä¾èµ–ï¼ˆéœ€è¦å®‰è£…ï¼‰
```json
{
  "expo-notifications": "^0.32.12",        // âœ… å·²å®‰è£… - æœ¬åœ°é€šçŸ¥
  "expo-av": "~14.0.8",                     // ğŸ”´ éœ€å®‰è£… - éŸ³é¢‘æ’­æ”¾
  "expo-speech": "~12.0.2",                 // âœ… å·²å®‰è£… - è¯­éŸ³æ’­æŠ¥
  "expo-haptics": "~15.0.7",                // âœ… å·²å®‰è£… - è§¦è§‰åé¦ˆ
  "expo-device": "^8.0.9",                  // âœ… å·²å®‰è£… - è®¾å¤‡ä¿¡æ¯
  "expo-background-fetch": "~12.0.1",       // ğŸ”´ éœ€å®‰è£… - åå°ä»»åŠ¡
  "expo-task-manager": "~11.9.1",           // ğŸ”´ éœ€å®‰è£… - ä»»åŠ¡ç®¡ç†
  "react-native-sensor-manager": "latest"   // ğŸ”´ éœ€å®‰è£… - æ‘‡ä¸€æ‘‡ä¼ æ„Ÿå™¨
}
```

### 2. åŸç”Ÿèƒ½åŠ›é…ç½®

#### iOS (Info.plist)
```xml
<!-- åå°éŸ³é¢‘æ’­æ”¾ -->
<key>UIBackgroundModes</key>
<array>
  <string>audio</string>              <!-- éŸ³é¢‘åå° -->
  <string>processing</string>         <!-- åå°å¤„ç† -->
  <string>fetch</string>              <!-- åå°è·å– -->
</array>

<!-- é€šçŸ¥æƒé™ -->
<key>NSUserNotificationUsageDescription</key>
<string>We need notifications to wake you up with alarms</string>

<!-- å§‹ç»ˆä¿æŒæ¿€æ´»ï¼ˆå¯é€‰ï¼Œæ…ç”¨ï¼‰ -->
<key>UIApplicationExitsOnSuspend</key>
<false/>
```

#### app.json é…ç½®
```json
{
  "expo": {
    "plugins": [
      "expo-router",
      "expo-font",
      "expo-web-browser",
      [
        "expo-notifications",
        {
          "icon": "./assets/images/notification-icon.png",
          "color": "#FF8C42",
          "sounds": [
            "./assets/sounds/alarm-ringtone.mp3",
            "./assets/sounds/gentle-wake.mp3"
          ]
        }
      ],
      [
        "expo-av",
        {
          "microphonePermission": false
        }
      ],
      [
        "expo-background-fetch",
        {
          "backgroundFetchInterval": 60
        }
      ]
    ],
    "ios": {
      "supportsTablet": true,
      "bundleIdentifier": "com.fanthus.bolt-expo-nativewind",
      "infoPlist": {
        "UIBackgroundModes": ["audio", "processing", "fetch"]
      }
    }
  }
}
```

---

## ğŸ”§ å®ç°æ¨¡å—è¯¦è§£

### Module 1: åŸç”Ÿé€šçŸ¥è°ƒåº¦å™¨ (`lib/alarmScheduler.js`)

**åŠŸèƒ½ï¼š**
- æ³¨å†Œ/å–æ¶ˆæœ¬åœ°é€šçŸ¥
- å¤„ç†é‡å¤é—¹é’Ÿï¼ˆæ¯æ—¥ã€å·¥ä½œæ—¥ã€è‡ªå®šä¹‰ï¼‰
- Snooze é‡æ–°è°ƒåº¦

```javascript
import * as Notifications from 'expo-notifications';
import { Platform } from 'react-native';

// é…ç½®é€šçŸ¥è¡Œä¸º
Notifications.setNotificationHandler({
  handleNotification: async () => ({
    shouldShowAlert: true,
    shouldPlaySound: true,
    shouldSetBadge: false,
    priority: Notifications.AndroidNotificationPriority.MAX, // Android æœ€é«˜ä¼˜å…ˆçº§
  }),
});

/**
 * è°ƒåº¦é—¹é’Ÿé€šçŸ¥
 * @param {Object} alarm - é—¹é’Ÿé…ç½®
 * @returns {Promise<string>} notificationId
 */
export async function scheduleAlarm(alarm) {
  const { id, time, label, repeatDays, wakeMode, ringtone } = alarm;

  // è§£ææ—¶é—´ï¼ˆæ ¼å¼ï¼šHH:mmï¼‰
  const [hours, minutes] = time.split(':').map(Number);
  const triggerDate = new Date();
  triggerDate.setHours(hours, minutes, 0, 0);

  // å¦‚æœæ—¶é—´å·²è¿‡ï¼Œè®¾ç½®ä¸ºæ˜å¤©
  if (triggerDate < new Date()) {
    triggerDate.setDate(triggerDate.getDate() + 1);
  }

  // é…ç½®è§¦å‘å™¨
  const trigger = {
    hour: hours,
    minute: minutes,
    repeats: repeatDays && repeatDays.length > 0,
  };

  // è°ƒåº¦é€šçŸ¥
  const notificationId = await Notifications.scheduleNotificationAsync({
    identifier: `alarm-${id}`,
    content: {
      title: 'â° Time to Wake Up!',
      body: label || 'Your alarm is ringing',
      sound: ringtone || 'default',
      priority: 'max',
      data: {
        alarmId: id,
        wakeMode,
        action: 'WAKE_UP',
      },
      categoryIdentifier: 'ALARM_CATEGORY', // ç”¨äºè‡ªå®šä¹‰åŠ¨ä½œ
    },
    trigger,
  });

  return notificationId;
}

/**
 * å–æ¶ˆé—¹é’Ÿ
 */
export async function cancelAlarm(alarmId) {
  await Notifications.cancelScheduledNotificationAsync(`alarm-${alarmId}`);
}

/**
 * è°ƒåº¦ Snoozeï¼ˆ5åˆ†é’Ÿåï¼‰
 */
export async function scheduleSnooze(alarm) {
  const notificationId = await Notifications.scheduleNotificationAsync({
    identifier: `snooze-${alarm.id}-${Date.now()}`,
    content: {
      title: 'ğŸ˜´ Snooze Time Over',
      body: alarm.label || 'Time to wake up again',
      sound: alarm.ringtone || 'default',
      priority: 'max',
      data: {
        alarmId: alarm.id,
        wakeMode: alarm.wakeMode,
        action: 'SNOOZE_END',
      },
    },
    trigger: {
      seconds: 300, // 5åˆ†é’Ÿ = 300ç§’
    },
  });

  return notificationId;
}

/**
 * æ³¨å†Œé€šçŸ¥ç±»åˆ«å’ŒåŠ¨ä½œï¼ˆiOSï¼‰
 */
export async function registerNotificationCategories() {
  if (Platform.OS === 'ios') {
    await Notifications.setNotificationCategoryAsync('ALARM_CATEGORY', [
      {
        identifier: 'SNOOZE_ACTION',
        buttonTitle: 'Snooze 5 min',
        options: {
          opensAppToForeground: false,
        },
      },
      {
        identifier: 'STOP_ACTION',
        buttonTitle: "I'm up",
        options: {
          opensAppToForeground: true,
        },
      },
    ]);
  }
}
```

---

### Module 2: éŸ³é¢‘æ’­æ”¾ç®¡ç†å™¨ (`lib/audioManager.js`)

**åŠŸèƒ½ï¼š**
- æ’­æ”¾è‡ªå®šä¹‰é“ƒå£°
- TTS è¯­éŸ³æ’­æŠ¥
- åå°éŸ³é¢‘æ¨¡å¼
- éŸ³é‡æ§åˆ¶

```javascript
import { Audio } from 'expo-av';
import * as Speech from 'expo-speech';

let currentSound = null;

/**
 * åˆå§‹åŒ–éŸ³é¢‘ä¼šè¯ï¼ˆæ”¯æŒåå°æ’­æ”¾ï¼‰
 */
export async function initAudioSession() {
  try {
    await Audio.setAudioModeAsync({
      allowsRecordingIOS: false,
      playsInSilentModeIOS: true,        // é™éŸ³æ¨¡å¼ä¹Ÿæ’­æ”¾
      staysActiveInBackground: true,     // åå°ä¿æŒæ¿€æ´»
      shouldDuckAndroid: true,
      playThroughEarpieceAndroid: false,
    });
  } catch (error) {
    console.error('Failed to set audio mode:', error);
  }
}

/**
 * æ’­æ”¾é“ƒå£°
 * @param {string} ringtoneUri - é“ƒå£°æ–‡ä»¶ URI
 * @param {boolean} loop - æ˜¯å¦å¾ªç¯æ’­æ”¾
 */
export async function playAlarmRingtone(ringtoneUri, loop = true) {
  try {
    // åœæ­¢å½“å‰æ’­æ”¾
    if (currentSound) {
      await currentSound.stopAsync();
      await currentSound.unloadAsync();
    }

    // åŠ è½½å¹¶æ’­æ”¾æ–°é“ƒå£°
    const { sound } = await Audio.Sound.createAsync(
      { uri: ringtoneUri } || require('../assets/sounds/default-alarm.mp3'),
      {
        isLooping: loop,
        volume: 1.0,
        shouldPlay: true,
      }
    );

    currentSound = sound;

    // ç›‘å¬æ’­æ”¾å®Œæˆ
    sound.setOnPlaybackStatusUpdate((status) => {
      if (status.didJustFinish && !status.isLooping) {
        console.log('Ringtone finished playing');
      }
    });

    return sound;
  } catch (error) {
    console.error('Failed to play ringtone:', error);
    return null;
  }
}

/**
 * åœæ­¢é“ƒå£°
 */
export async function stopAlarmRingtone() {
  if (currentSound) {
    try {
      await currentSound.stopAsync();
      await currentSound.unloadAsync();
      currentSound = null;
    } catch (error) {
      console.error('Failed to stop ringtone:', error);
    }
  }
}

/**
 * æ’­æ”¾è¯­éŸ³æ’­æŠ¥
 * @param {string} text - æ’­æŠ¥æ–‡æœ¬
 */
export async function speakWakeMessage(text) {
  try {
    // æ£€æŸ¥æ˜¯å¦æ­£åœ¨æ’­æ”¾
    const isSpeaking = await Speech.isSpeakingAsync();
    if (isSpeaking) {
      await Speech.stop();
    }

    // æ’­æ”¾è¯­éŸ³
    await Speech.speak(text, {
      language: 'en-US',
      pitch: 1.0,
      rate: 0.9,
      volume: 1.0,
      voice: 'com.apple.ttsbundle.Samantha-compact', // iOS
    });
  } catch (error) {
    console.error('Failed to speak:', error);
  }
}

/**
 * åœæ­¢è¯­éŸ³æ’­æŠ¥
 */
export async function stopSpeaking() {
  try {
    await Speech.stop();
  } catch (error) {
    console.error('Failed to stop speech:', error);
  }
}

/**
 * æ’­æ”¾é—¹é’Ÿï¼ˆé“ƒå£° + è¯­éŸ³ï¼‰
 */
export async function playWakeSequence(alarm) {
  await initAudioSession();

  // æ’­æ”¾é“ƒå£°
  if (alarm.wakeMode === 'ringtone' && alarm.ringtoneUrl) {
    await playAlarmRingtone(alarm.ringtoneUrl);
  }

  // æ’­æ”¾è¯­éŸ³æ’­æŠ¥
  if (alarm.wakeMode === 'voice' && alarm.broadcastContent) {
    await speakWakeMessage(alarm.broadcastContent);
  }
}

/**
 * åœæ­¢æ‰€æœ‰å£°éŸ³
 */
export async function stopAllSounds() {
  await stopAlarmRingtone();
  await stopSpeaking();
}
```

---

### Module 3: åå°ä»»åŠ¡å¤„ç†å™¨ (`lib/backgroundAlarmTask.js`)

**åŠŸèƒ½ï¼š**
- ç›‘å¬é—¹é’Ÿè§¦å‘æ—¶é—´
- è‡ªåŠ¨å”¤é†’åº”ç”¨
- è·³è½¬åˆ°å”¤é†’é¡µé¢

```javascript
import * as BackgroundFetch from 'expo-background-fetch';
import * as TaskManager from 'expo-task-manager';
import * as Notifications from 'expo-notifications';
import { router } from 'expo-router';

const ALARM_BACKGROUND_TASK = 'ALARM_BACKGROUND_TASK';

/**
 * å®šä¹‰åå°ä»»åŠ¡
 */
TaskManager.defineTask(ALARM_BACKGROUND_TASK, async () => {
  try {
    console.log('[Background Task] Checking for alarms...');

    // è·å–æ‰€æœ‰å¾…è§¦å‘çš„é€šçŸ¥
    const notifications = await Notifications.getAllScheduledNotificationsAsync();

    // æ£€æŸ¥æ˜¯å¦æœ‰å³å°†è§¦å‘çš„é—¹é’Ÿï¼ˆ1åˆ†é’Ÿå†…ï¼‰
    const now = Date.now();
    const upcomingAlarms = notifications.filter((notif) => {
      const trigger = notif.trigger;
      const triggerTime = trigger.value || trigger.date;
      return triggerTime && triggerTime - now < 60000; // 1åˆ†é’Ÿå†…
    });

    if (upcomingAlarms.length > 0) {
      console.log('[Background Task] Upcoming alarm detected');
      // è¿™é‡Œå¯ä»¥é¢„åŠ è½½èµ„æºæˆ–å‡†å¤‡å”¤é†’é¡µé¢
    }

    return BackgroundFetch.BackgroundFetchResult.NewData;
  } catch (error) {
    console.error('[Background Task] Error:', error);
    return BackgroundFetch.BackgroundFetchResult.Failed;
  }
});

/**
 * æ³¨å†Œåå°ä»»åŠ¡
 */
export async function registerBackgroundTask() {
  try {
    const isRegistered = await TaskManager.isTaskRegisteredAsync(ALARM_BACKGROUND_TASK);

    if (!isRegistered) {
      await BackgroundFetch.registerTaskAsync(ALARM_BACKGROUND_TASK, {
        minimumInterval: 60, // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
        stopOnTerminate: false,
        startOnBoot: true,
      });
      console.log('[Background Task] Registered successfully');
    }
  } catch (error) {
    console.error('[Background Task] Registration failed:', error);
  }
}

/**
 * æ³¨é”€åå°ä»»åŠ¡
 */
export async function unregisterBackgroundTask() {
  try {
    await BackgroundFetch.unregisterTaskAsync(ALARM_BACKGROUND_TASK);
    console.log('[Background Task] Unregistered');
  } catch (error) {
    console.error('[Background Task] Unregister failed:', error);
  }
}

/**
 * è®¾ç½®é€šçŸ¥å“åº”å¤„ç†å™¨ï¼ˆæ‰“å¼€å”¤é†’é¡µé¢ï¼‰
 */
export function setupNotificationResponseHandler() {
  Notifications.addNotificationResponseReceivedListener((response) => {
    const { alarmId, action } = response.notification.request.content.data;

    console.log('[Notification Response]', action, alarmId);

    if (action === 'WAKE_UP' || action === 'SNOOZE_END') {
      // å¯¼èˆªåˆ°å”¤é†’é¡µé¢
      router.push({
        pathname: '/alarm/wake-up',
        params: { alarmId },
      });
    }
  });
}
```

---

### Module 4: å”¤é†’é¡µé¢ç»„ä»¶ (`app/alarm/wake-up.jsx`)

**åŠŸèƒ½ï¼š**
- å…¨å±æ˜¾ç¤º
- æ˜¾ç¤ºé—¹é’Ÿä¿¡æ¯
- æ’­æ”¾å£°éŸ³
- äº’åŠ¨ä»»åŠ¡
- Snooze / Stop æŒ‰é’®

```javascript
import { View, Text, StyleSheet, TouchableOpacity, Animated } from 'react-native';
import { LinearGradient } from 'expo-linear-gradient';
import { useState, useEffect, useRef } from 'react';
import { useLocalSearchParams, router } from 'expo-router';
import { SafeAreaView } from 'react-native-safe-area-context';
import * as Haptics from 'expo-haptics';
import useStore from '../../lib/store';
import { playWakeSequence, stopAllSounds } from '../../lib/audioManager';
import { scheduleSnooze } from '../../lib/alarmScheduler';
import MonsterIcon from '../../components/MonsterIcon';
import ShakeTaskCard from '../../components/ShakeTaskCard';

export default function WakeUpScreen() {
  const { alarmId } = useLocalSearchParams();
  const alarm = useStore((state) => state.alarms.find((a) => a.id === alarmId));

  const [currentTime, setCurrentTime] = useState(new Date());
  const [taskCompleted, setTaskCompleted] = useState(false);
  const pulseAnim = useRef(new Animated.Value(1)).current;

  useEffect(() => {
    // æ’­æ”¾é—¹é’Ÿå£°éŸ³
    if (alarm) {
      playWakeSequence(alarm);
    }

    // æ›´æ–°æ—¶é—´
    const timer = setInterval(() => setCurrentTime(new Date()), 1000);

    // æ€ªå…½å‘¼å¸åŠ¨ç”»
    Animated.loop(
      Animated.sequence([
        Animated.timing(pulseAnim, {
          toValue: 1.1,
          duration: 1000,
          useNativeDriver: true,
        }),
        Animated.timing(pulseAnim, {
          toValue: 1,
          duration: 1000,
          useNativeDriver: true,
        }),
      ])
    ).start();

    return () => {
      clearInterval(timer);
      stopAllSounds();
    };
  }, [alarm]);

  const handleSnooze = async () => {
    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);

    // åœæ­¢å£°éŸ³
    await stopAllSounds();

    // è°ƒåº¦ 5 åˆ†é’Ÿåçš„ Snooze
    await scheduleSnooze(alarm);

    // å…³é—­é¡µé¢
    router.back();
  };

  const handleStop = async () => {
    // æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å®Œæˆ
    if (alarm.task !== 'none' && !taskCompleted) {
      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Warning);
      alert('Please complete the wake task first!');
      return;
    }

    Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);

    // åœæ­¢å£°éŸ³
    await stopAllSounds();

    // è®°å½•å”¤é†’äº‹ä»¶åˆ° Supabase
    await useStore.getState().addWakeEvent({
      alarmId,
      timestamp: new Date().toISOString(),
      completedTask: alarm.task !== 'none',
    });

    // å…³é—­é¡µé¢
    router.replace('/');
  };

  if (!alarm) {
    return null;
  }

  const timeString = currentTime.toLocaleTimeString('en-US', {
    hour: '2-digit',
    minute: '2-digit',
    hour12: false,
  });

  return (
    <View style={styles.container}>
      {/* æ¸å˜èƒŒæ™¯ */}
      <LinearGradient
        colors={['#A8D5E2', '#FFE8B8', '#FFD1A3']}
        locations={[0, 0.6, 1]}
        style={StyleSheet.absoluteFill}
      />

      <SafeAreaView style={styles.content} edges={['top', 'bottom']}>
        {/* æ—¶é—´æ˜¾ç¤º */}
        <View style={styles.timeSection}>
          <Text style={styles.timeText}>{timeString}</Text>
          <Text style={styles.labelText}>
            {alarm.label} Â· {alarm.repeatDisplay || 'Once'}
          </Text>
        </View>

        {/* æ€ªå…½å›¾æ ‡ */}
        <Animated.View
          style={[
            styles.monsterContainer,
            { transform: [{ scale: pulseAnim }] },
          ]}
        >
          <MonsterIcon size={180} type="morning" />
        </Animated.View>

        {/* é—®å€™è¯­ */}
        <View style={styles.messageSection}>
          <Text style={styles.greetingText}>Good morning,</Text>
          <Text style={styles.greetingText}>I'm waking you up ğŸ¾</Text>

          {alarm.wakeMode === 'voice' && alarm.broadcastContent && (
            <Text style={styles.broadcastText}>{alarm.broadcastContent}</Text>
          )}
        </View>

        {/* äº’åŠ¨ä»»åŠ¡ */}
        {alarm.task !== 'none' && (
          <ShakeTaskCard
            taskType={alarm.task}
            onComplete={() => setTaskCompleted(true)}
            completed={taskCompleted}
          />
        )}

        {/* æŒ‰é’® */}
        <View style={styles.buttonContainer}>
          <TouchableOpacity
            style={styles.snoozeButton}
            onPress={handleSnooze}
            activeOpacity={0.8}
          >
            <Text style={styles.snoozeButtonText}>Snooze 5 min</Text>
          </TouchableOpacity>

          <TouchableOpacity
            style={[
              styles.stopButton,
              (!taskCompleted && alarm.task !== 'none') && styles.stopButtonDisabled,
            ]}
            onPress={handleStop}
            activeOpacity={0.8}
          >
            <Text style={styles.stopButtonText}>I'm up</Text>
          </TouchableOpacity>
        </View>
      </SafeAreaView>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
  },
  content: {
    flex: 1,
    paddingHorizontal: 24,
    justifyContent: 'space-between',
  },
  timeSection: {
    alignItems: 'center',
    marginTop: 40,
  },
  timeText: {
    fontSize: 72,
    fontWeight: '300',
    color: '#1A2B3C',
    letterSpacing: -2,
  },
  labelText: {
    fontSize: 18,
    color: '#4A5A6A',
    marginTop: 8,
  },
  monsterContainer: {
    alignSelf: 'center',
    marginVertical: 40,
  },
  messageSection: {
    alignItems: 'center',
    paddingHorizontal: 32,
  },
  greetingText: {
    fontSize: 28,
    fontWeight: '600',
    color: '#1A2B3C',
    textAlign: 'center',
  },
  broadcastText: {
    fontSize: 16,
    color: '#5A6A7A',
    textAlign: 'center',
    marginTop: 16,
    lineHeight: 24,
  },
  buttonContainer: {
    flexDirection: 'row',
    gap: 12,
    marginBottom: 20,
  },
  snoozeButton: {
    flex: 1,
    backgroundColor: '#FFFFFF',
    paddingVertical: 18,
    borderRadius: 16,
    alignItems: 'center',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.1,
    shadowRadius: 8,
    elevation: 4,
  },
  snoozeButtonText: {
    fontSize: 18,
    fontWeight: '600',
    color: '#1A2B3C',
  },
  stopButton: {
    flex: 1,
    backgroundColor: '#FF8C42',
    paddingVertical: 18,
    borderRadius: 16,
    alignItems: 'center',
    shadowColor: '#FF8C42',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 8,
    elevation: 4,
  },
  stopButtonDisabled: {
    backgroundColor: '#CCCCCC',
  },
  stopButtonText: {
    fontSize: 18,
    fontWeight: '700',
    color: '#FFFFFF',
  },
});
```

---

### Module 5: æ‘‡ä¸€æ‘‡ä»»åŠ¡ç»„ä»¶ (`components/ShakeTaskCard.jsx`)

```javascript
import { View, Text, StyleSheet } from 'react-native';
import { useState, useEffect } from 'react';
import { Accelerometer } from 'expo-sensors';
import * as Haptics from 'expo-haptics';

export default function ShakeTaskCard({ taskType, onComplete, completed }) {
  const [shakeCount, setShakeCount] = useState(0);
  const [subscription, setSubscription] = useState(null);

  const requiredShakes = taskType === 'shake' ? 3 : 0;

  useEffect(() => {
    if (taskType !== 'shake' || completed) return;

    let lastShake = 0;
    const SHAKE_THRESHOLD = 1.5;

    const sub = Accelerometer.addListener(({ x, y, z }) => {
      const acceleration = Math.sqrt(x * x + y * y + z * z);
      const now = Date.now();

      if (acceleration > SHAKE_THRESHOLD && now - lastShake > 500) {
        lastShake = now;
        setShakeCount((prev) => {
          const newCount = prev + 1;
          Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);

          if (newCount >= requiredShakes) {
            onComplete();
            Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);
          }

          return newCount;
        });
      }
    });

    Accelerometer.setUpdateInterval(100);
    setSubscription(sub);

    return () => {
      sub && sub.remove();
    };
  }, [taskType, completed]);

  if (taskType === 'none') return null;

  return (
    <View style={styles.card}>
      <Text style={styles.title}>Wake Task</Text>
      <Text style={styles.instruction}>
        Shake your phone {requiredShakes} times to turn off the alarm Â· {shakeCount}/{requiredShakes}
      </Text>
      {completed && <Text style={styles.completedText}>âœ“ Task Completed!</Text>}
    </View>
  );
}

const styles = StyleSheet.create({
  card: {
    backgroundColor: 'rgba(255, 255, 255, 0.9)',
    padding: 24,
    borderRadius: 20,
    marginVertical: 20,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.1,
    shadowRadius: 12,
  },
  title: {
    fontSize: 22,
    fontWeight: '700',
    color: '#1A2B3C',
    marginBottom: 12,
    textAlign: 'center',
  },
  instruction: {
    fontSize: 16,
    color: '#4A5A6A',
    textAlign: 'center',
    lineHeight: 24,
  },
  completedText: {
    fontSize: 18,
    fontWeight: '600',
    color: '#4CAF50',
    textAlign: 'center',
    marginTop: 12,
  },
});
```

---

## ğŸ—„ï¸ Supabase æ•°æ®åº“è®¾è®¡

### æ–°å¢è¡¨ï¼š`wake_events`

```sql
/*
  # Wake Events Table

  1. New Tables
    - `wake_events`
      - `id` (uuid, primary key)
      - `user_id` (text) - ç”¨æˆ·æ ‡è¯†
      - `alarm_id` (text) - é—¹é’Ÿ ID
      - `timestamp` (timestamptz) - è§¦å‘æ—¶é—´
      - `action` (text) - åŠ¨ä½œç±»å‹ï¼š'snoozed', 'dismissed', 'completed'
      - `completed_task` (boolean) - æ˜¯å¦å®Œæˆä»»åŠ¡
      - `snooze_count` (integer) - å°ç¡æ¬¡æ•°
      - `created_at` (timestamptz)

  2. Security
    - Enable RLS
    - Add policy for authenticated users
*/

CREATE TABLE IF NOT EXISTS wake_events (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id text NOT NULL,
  alarm_id text NOT NULL,
  timestamp timestamptz NOT NULL,
  action text NOT NULL CHECK (action IN ('snoozed', 'dismissed', 'completed')),
  completed_task boolean DEFAULT false,
  snooze_count integer DEFAULT 0,
  created_at timestamptz DEFAULT now()
);

ALTER TABLE wake_events ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can read own wake events"
  ON wake_events
  FOR SELECT
  TO authenticated
  USING (true);

CREATE POLICY "Users can insert own wake events"
  ON wake_events
  FOR INSERT
  TO authenticated
  WITH CHECK (true);

CREATE INDEX idx_wake_events_timestamp ON wake_events(timestamp DESC);
CREATE INDEX idx_wake_events_alarm_id ON wake_events(alarm_id);
```

### æ›´æ–° `alarms` è¡¨ï¼ˆæ·»åŠ æ–°å­—æ®µï¼‰

```sql
ALTER TABLE alarms ADD COLUMN IF NOT EXISTS notification_id text;
ALTER TABLE alarms ADD COLUMN IF NOT EXISTS last_triggered_at timestamptz;
ALTER TABLE alarms ADD COLUMN IF NOT EXISTS snooze_count integer DEFAULT 0;
```

---

## ğŸ“± å®Œæ•´å·¥ä½œæµç¨‹

### 1ï¸âƒ£ ç”¨æˆ·åˆ›å»ºé—¹é’Ÿ
```
ç”¨æˆ·è¾“å…¥é—¹é’Ÿä¿¡æ¯
  â†“
ä¿å­˜åˆ° Zustand Store
  â†“
ä¿å­˜åˆ° AsyncStorage
  â†“
è°ƒç”¨ scheduleAlarm() æ³¨å†Œé€šçŸ¥
  â†“
è¿”å› notificationId å¹¶ä¿å­˜
```

### 2ï¸âƒ£ é—¹é’Ÿè§¦å‘ï¼ˆåå°ï¼‰
```
ç³»ç»Ÿæ—¶é—´åˆ°è¾¾è®¾å®šæ—¶é—´
  â†“
iOS/Android ç³»ç»Ÿè§¦å‘é€šçŸ¥
  â†“
æ’­æ”¾ç³»ç»Ÿé€šçŸ¥å£°éŸ³
  â†“
æ˜¾ç¤ºé€šçŸ¥æ¨ªå¹…
  â†“
[ç”¨æˆ·ç‚¹å‡»é€šçŸ¥]
  â†“
è§¦å‘ NotificationResponse ç›‘å¬å™¨
  â†“
router.push('/alarm/wake-up')
```

### 3ï¸âƒ£ å”¤é†’é¡µé¢å±•ç¤º
```
WakeUpScreen åŠ è½½
  â†“
è·å–é—¹é’Ÿé…ç½®
  â†“
è°ƒç”¨ playWakeSequence()
  - æ’­æ”¾è‡ªå®šä¹‰é“ƒå£°ï¼ˆå¾ªç¯ï¼‰
  - æˆ–æ’­æ”¾ TTS è¯­éŸ³
  â†“
æ˜¾ç¤ºä»»åŠ¡å¡ç‰‡ï¼ˆå¦‚æœ‰ï¼‰
  â†“
ç­‰å¾…ç”¨æˆ·æ“ä½œ
```

### 4ï¸âƒ£ ç”¨æˆ·æ“ä½œåˆ†æ”¯

**A. ç‚¹å‡» Snoozeï¼š**
```
stopAllSounds()
  â†“
scheduleSnooze(alarm) - æ³¨å†Œ 5 åˆ†é’Ÿåé€šçŸ¥
  â†“
è®°å½•åˆ° wake_events (action: 'snoozed')
  â†“
router.back()
```

**B. å®Œæˆä»»åŠ¡ â†’ ç‚¹å‡» I'm upï¼š**
```
æ£€æŸ¥ä»»åŠ¡å®ŒæˆçŠ¶æ€
  â†“
stopAllSounds()
  â†“
è®°å½•åˆ° wake_events (action: 'completed', completed_task: true)
  â†“
æ›´æ–°é—¹é’Ÿç»Ÿè®¡ä¿¡æ¯
  â†“
router.replace('/') - è¿”å›é¦–é¡µ
```

---

## ğŸš€ å®æ–½æ­¥éª¤ï¼ˆTodo Listï¼‰

### é˜¶æ®µ 1: ç¯å¢ƒå‡†å¤‡ï¼ˆç¬¬ 1-2 å¤©ï¼‰
- [ ] å®‰è£…å¿…éœ€ä¾èµ–åŒ…
  - [ ] `expo-av`
  - [ ] `expo-background-fetch`
  - [ ] `expo-task-manager`
  - [ ] `expo-sensors`ï¼ˆç”¨äºæ‘‡ä¸€æ‘‡ï¼‰
- [ ] é…ç½® `app.json` æ’ä»¶
- [ ] æ›´æ–° iOS `Info.plist` æƒé™
- [ ] å‡†å¤‡éŸ³é¢‘èµ„æºæ–‡ä»¶
  - [ ] é»˜è®¤é“ƒå£° `default-alarm.mp3`
  - [ ] æŸ”å’Œé“ƒå£° `gentle-wake.mp3`

### é˜¶æ®µ 2: æ ¸å¿ƒæ¨¡å—å¼€å‘ï¼ˆç¬¬ 3-5 å¤©ï¼‰
- [ ] å®ç° `lib/alarmScheduler.js`
  - [ ] `scheduleAlarm()`
  - [ ] `cancelAlarm()`
  - [ ] `scheduleSnooze()`
  - [ ] `registerNotificationCategories()`
- [ ] å®ç° `lib/audioManager.js`
  - [ ] `initAudioSession()`
  - [ ] `playAlarmRingtone()`
  - [ ] `speakWakeMessage()`
  - [ ] `stopAllSounds()`
- [ ] å®ç° `lib/backgroundAlarmTask.js`
  - [ ] `registerBackgroundTask()`
  - [ ] `setupNotificationResponseHandler()`

### é˜¶æ®µ 3: UI ç»„ä»¶å¼€å‘ï¼ˆç¬¬ 6-8 å¤©ï¼‰
- [ ] åˆ›å»º `app/alarm/wake-up.jsx`
  - [ ] å…¨å±å¸ƒå±€
  - [ ] æ—¶é—´æ˜¾ç¤º
  - [ ] æ€ªå…½åŠ¨ç”»
  - [ ] é—®å€™è¯­æ˜¾ç¤º
  - [ ] æŒ‰é’®åŠŸèƒ½
- [ ] åˆ›å»º `components/ShakeTaskCard.jsx`
  - [ ] åŠ é€Ÿåº¦è®¡ç›‘å¬
  - [ ] è¿›åº¦æ˜¾ç¤º
  - [ ] å®Œæˆåé¦ˆ
- [ ] åˆ›å»ºå…¶ä»–ä»»åŠ¡ç»„ä»¶
  - [ ] `components/MathTaskCard.jsx`ï¼ˆç­”é¢˜ï¼‰
  - [ ] `components/MemoryTaskCard.jsx`ï¼ˆè®°å¿†ï¼‰

### é˜¶æ®µ 4: é›†æˆä¸æµ‹è¯•ï¼ˆç¬¬ 9-10 å¤©ï¼‰
- [ ] é›†æˆåˆ°ç°æœ‰é—¹é’Ÿæµç¨‹
  - [ ] æ›´æ–° `useStore` æ·»åŠ æ–°æ–¹æ³•
  - [ ] ä¿®æ”¹é—¹é’Ÿåˆ›å»ºæµç¨‹è°ƒç”¨ scheduler
  - [ ] ä¿®æ”¹é—¹é’Ÿç¼–è¾‘/åˆ é™¤æµç¨‹
- [ ] æƒé™è¯·æ±‚æµç¨‹
  - [ ] é€šçŸ¥æƒé™
  - [ ] åå°ä»»åŠ¡æƒé™
  - [ ] ä¼ æ„Ÿå™¨æƒé™
- [ ] Supabase é›†æˆ
  - [ ] åˆ›å»º `wake_events` è¡¨
  - [ ] å®ç°æ•°æ®åŒæ­¥é€»è¾‘

### é˜¶æ®µ 5: ä¼˜åŒ–ä¸æ‰“ç£¨ï¼ˆç¬¬ 11-12 å¤©ï¼‰
- [ ] åå°ç¨³å®šæ€§æµ‹è¯•
  - [ ] åº”ç”¨å…³é—­æ—¶è§¦å‘
  - [ ] ä½ç”µé‡æ¨¡å¼æµ‹è¯•
  - [ ] å¤šä¸ªé—¹é’Ÿå¹¶å‘æµ‹è¯•
- [ ] éŸ³é¢‘ä½“éªŒä¼˜åŒ–
  - [ ] æ¸å¼ºéŸ³é‡ï¼ˆæ·¡å…¥æ•ˆæœï¼‰
  - [ ] è¯­éŸ³æ’­æŠ¥è‡ªç„¶åº¦è°ƒæ•´
- [ ] UI/UX æ‰“ç£¨
  - [ ] åŠ¨ç”»æµç•…åº¦
  - [ ] è§¦è§‰åé¦ˆ
  - [ ] é”™è¯¯æç¤º

### é˜¶æ®µ 6: ä¸Šçº¿å‡†å¤‡ï¼ˆç¬¬ 13-14 å¤©ï¼‰
- [ ] æ„å»ºæµ‹è¯•ç‰ˆæœ¬
  - [ ] `npx expo run:ios`
  - [ ] TestFlight åˆ†å‘
- [ ] æ–‡æ¡£ç¼–å†™
  - [ ] ç”¨æˆ·ä½¿ç”¨æŒ‡å—
  - [ ] æ•…éšœæ’æŸ¥æ–‡æ¡£
- [ ] æäº¤å®¡æ ¸ï¼ˆå¦‚éœ€è¦ï¼‰

---

## âš ï¸ æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ

### éš¾ç‚¹ 1: iOS åå°é™åˆ¶
**é—®é¢˜ï¼š** iOS ä¸¥æ ¼é™åˆ¶åå°ä»»åŠ¡æ‰§è¡Œæ—¶é—´ï¼ˆé€šå¸¸åªæœ‰ 30 ç§’ï¼‰

**è§£å†³æ–¹æ¡ˆï¼š**
- ä½¿ç”¨ `UNUserNotificationCenter` ä¾èµ–ç³»ç»Ÿè°ƒåº¦ï¼ˆæœ€å¯é ï¼‰
- è®¾ç½® `UIBackgroundModes: audio` ä¿æŒéŸ³é¢‘ä¼šè¯
- ä¸ä¾èµ– JS åå°ä»»åŠ¡ï¼Œè€Œæ˜¯ä½¿ç”¨ç³»ç»Ÿé€šçŸ¥ + ç”¨æˆ·ç‚¹å‡»è§¦å‘

### éš¾ç‚¹ 2: è‡ªåŠ¨å…¨å±å”¤é†’
**é—®é¢˜ï¼š** iOS ä¸å…è®¸åº”ç”¨è‡ªåŠ¨å”¤é†’åˆ°å‰å°

**è§£å†³æ–¹æ¡ˆï¼š**
- **æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰ï¼š** ä½¿ç”¨é«˜ä¼˜å…ˆçº§é€šçŸ¥ + å…¨å±æ¨ªå¹…ï¼Œç”¨æˆ·ç‚¹å‡»åæ‰“å¼€
- **æ–¹æ¡ˆ Bï¼ˆé«˜çº§ï¼‰ï¼š** ä½¿ç”¨ `UNNotificationServiceExtension` è‡ªå®šä¹‰é€šçŸ¥ UI
- **æ–¹æ¡ˆ Cï¼ˆä¸æ¨èï¼‰ï¼š** å°è¯•ä½¿ç”¨ VoIP æ¨é€ï¼ˆå¯èƒ½è¢«æ‹’å®¡ï¼‰

### éš¾ç‚¹ 3: å£°éŸ³æŒç»­æ’­æ”¾
**é—®é¢˜ï¼š** é€šçŸ¥å£°éŸ³åªæ’­æ”¾ä¸€æ¬¡ï¼Œæ— æ³•å¾ªç¯

**è§£å†³æ–¹æ¡ˆï¼š**
- é€šçŸ¥åªè´Ÿè´£å”¤é†’ï¼ŒçœŸæ­£çš„é“ƒå£°åœ¨åº”ç”¨å†…é€šè¿‡ `expo-av` æ’­æ”¾
- è®¾ç½® `playsInSilentModeIOS: true` ç¡®ä¿é™éŸ³æ¨¡å¼ä¹Ÿèƒ½æ’­æ”¾
- ä½¿ç”¨ `isLooping: true` å®ç°å¾ªç¯æ’­æ”¾

### éš¾ç‚¹ 4: é‡å¤é—¹é’Ÿè°ƒåº¦
**é—®é¢˜ï¼š** è‡ªå®šä¹‰é‡å¤æ¨¡å¼ï¼ˆå¦‚åªåœ¨å·¥ä½œæ—¥ï¼‰

**è§£å†³æ–¹æ¡ˆï¼š**
```javascript
// ä¸ºæ¯ä¸ªéœ€è¦è§¦å‘çš„æ—¥æœŸå•ç‹¬æ³¨å†Œé€šçŸ¥
function scheduleRecurringAlarm(alarm) {
  const { repeatDays, time } = alarm;
  const notificationIds = [];

  repeatDays.forEach(day => {
    const trigger = {
      weekday: day, // 1=Sunday, 2=Monday, ...
      hour: parseInt(time.split(':')[0]),
      minute: parseInt(time.split(':')[1]),
      repeats: true,
    };

    const id = await Notifications.scheduleNotificationAsync({
      identifier: `alarm-${alarm.id}-day${day}`,
      content: { /* ... */ },
      trigger,
    });

    notificationIds.push(id);
  });

  return notificationIds;
}
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **éŸ³é¢‘èµ„æºä¼˜åŒ–**
   - ä½¿ç”¨ MP3 æ ¼å¼ï¼ˆiOS åŸç”Ÿæ”¯æŒï¼‰
   - æ–‡ä»¶å¤§å°æ§åˆ¶åœ¨ 2MB ä»¥å†…
   - é‡‡æ ·ç‡ 44.1kHz

2. **åå°ä»»åŠ¡ä¼˜åŒ–**
   - åªåœ¨çœŸæ­£éœ€è¦æ—¶æ³¨å†Œåå°ä»»åŠ¡
   - é¿å…é¢‘ç¹å”¤é†’ï¼ˆæœ€ä½é—´éš” 15 åˆ†é’Ÿï¼‰

3. **ç”µæ± ä¼˜åŒ–**
   - æ’­æ”¾å®Œæ¯•åŠæ—¶é‡Šæ”¾éŸ³é¢‘èµ„æº
   - å®Œæˆä»»åŠ¡åç«‹å³æ³¨é”€ç›‘å¬å™¨

4. **å†…å­˜ä¼˜åŒ–**
   - å”¤é†’é¡µé¢ä½¿ç”¨ `useMemo` ç¼“å­˜è®¡ç®—ç»“æœ
   - åŠ¨ç”»ä½¿ç”¨ `useNativeDriver: true`

---

## ğŸ¯ æ€»ç»“

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŸç”Ÿé›†æˆæ–¹æ¡ˆï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼š

1. **ä½¿ç”¨ç³»ç»Ÿé€šçŸ¥ä½œä¸ºè°ƒåº¦æ ¸å¿ƒ**ï¼ˆæœ€å¯é ï¼‰
2. **åº”ç”¨å†…æ’­æ”¾è‡ªå®šä¹‰å£°éŸ³**ï¼ˆç»•è¿‡é€šçŸ¥å£°éŸ³é™åˆ¶ï¼‰
3. **ç”¨æˆ·äº¤äº’è§¦å‘å…¨å±é¡µé¢**ï¼ˆç¬¦åˆ iOS è§„èŒƒï¼‰
4. **Supabase æŒä¹…åŒ–æ•°æ®**ï¼ˆç»Ÿè®¡åˆ†æï¼‰

å®æ–½éš¾åº¦ï¼šâ­â­â­â­ (ä¸­é«˜)
é¢„è®¡å¼€å‘æ—¶é—´ï¼š10-14 å¤©
iOS å®¡æ ¸é€šè¿‡ç‡ï¼š95%+ï¼ˆç¬¦åˆ Apple è§„èŒƒï¼‰

---

**ä¸‹ä¸€æ­¥å»ºè®®ï¼š**
æ˜¯å¦å¼€å§‹å®æ–½ï¼Ÿæˆ‘å¯ä»¥æŒ‰é˜¶æ®µé€æ­¥å®ç°æ¯ä¸ªæ¨¡å—ã€‚
